import{f as l,a as o,c as P}from"../chunks/BUlJwuR3.js";import"../chunks/BTdNyzyd.js";import{a0 as pa,a7 as w,a1 as na,a4 as r,a5 as n,a6 as s,b as v,p as a,D as z,a9 as m,a8 as I}from"../chunks/DnZ8aS1A.js";import{s as d,e as da}from"../chunks/0SPjzxuk.js";import{e as Q,i as R}from"../chunks/DYUyerag.js";import{i as b}from"../chunks/BtGiakpZ.js";import{s as ca}from"../chunks/B1NNja7f.js";import{i as _a}from"../chunks/CBqTb_35.js";import{p as ma}from"../chunks/B0Pe6GuM.js";var fa=l('<p style="margin-top: 1rem; opacity: 0.7;">No clusters returned from the worker. Check the /topics payload and mapping.</p>'),ua=l('<button><div class="topic-header svelte-1v4j99y"><span> </span> <span> </span></div> <div class="topic-words svelte-1v4j99y"> </div></button>'),ha=l("<p>Choose a topic on the left.</p>"),ya=l("<p>Loading docs…</p>"),ga=l('<p class="error svelte-1v4j99y"> </p>'),ja=l("<p>No docs found for this cluster.</p>"),xa=l('<li class="svelte-1v4j99y"><div class="doc-meta svelte-1v4j99y"> </div> <div class="doc-snippet svelte-1v4j99y"> </div></li>'),wa=l('<ul class="doc-list svelte-1v4j99y"></ul>'),ba=l('<h2> </h2> <p class="topic-words svelte-1v4j99y"> </p> <!>',1),ka=l('<div class="layout svelte-1v4j99y"><aside class="topics svelte-1v4j99y"><h1>Topics</h1> <p> </p> <!> <!></aside> <main class="details svelte-1v4j99y"><!></main></div>');function Aa(U,J){pa(J,!1);const D=ma(J,"data",8)().clusters??[];let c=z(null),g=z([]),E=z(!1),k=z(null);async function V(e){m(c,e),m(E,!0),m(k,null),m(g,[]);try{const t=await fetch(`/api/manna/cluster/${e.id}`);if(!t.ok)throw new Error(`Failed to load docs for cluster ${e.id}`);m(g,await t.json())}catch(t){console.error(t),m(k,t.message??"Something went wrong loading docs.")}finally{m(E,!1)}}_a();var F=ka(),L=r(F),T=n(r(L),2),W=r(T);s(T);var K=n(T,2);{var X=e=>{var t=fa();o(e,t)};b(K,e=>{v(()=>D.length===0)&&e(X)})}var Y=n(K,2);Q(Y,1,()=>D,R,(e,t)=>{var p=ua(),j=r(p),_=r(j),q=r(_);s(_);var C=n(_,2),A=r(C);s(C),s(j);var N=n(j,2),i=r(N,!0);s(N),s(p),w(f=>{ca(p,1,(a(c),a(t),v(()=>`topic-button ${a(c)?.id===a(t).id?"selected":""}`)),"svelte-1v4j99y"),d(q,`#${a(t),v(()=>a(t).id)??""}`),d(A,`${a(t),v(()=>a(t).size)??""} docs`),d(i,f)},[()=>(a(t),v(()=>a(t).words.join(" · ")))]),da("click",p,()=>V(a(t))),o(e,p)}),s(L);var M=n(L,2),Z=r(M);{var $=e=>{var t=ha();o(e,t)},aa=e=>{var t=ba(),p=I(t),j=r(p);s(p);var _=n(p,2),q=r(_,!0);s(_);var C=n(_,2);{var A=i=>{var f=ya();o(i,f)},N=i=>{var f=P(),ta=I(f);{var ea=u=>{var h=ga(),B=r(h,!0);s(h),w(()=>d(B,a(k))),o(u,h)},sa=u=>{var h=P(),B=I(h);{var ra=y=>{var x=ja();o(y,x)},oa=y=>{var x=wa();Q(x,5,()=>a(g),R,(va,S)=>{var G=xa(),H=r(G),ia=r(H,!0);s(H);var O=n(H,2),la=r(O,!0);s(O),s(G),w(()=>{d(ia,(a(S),v(()=>a(S).timestamp))),d(la,(a(S),v(()=>a(S).snippet)))}),o(va,G)}),s(x),o(y,x)};b(B,y=>{a(g),v(()=>a(g).length===0)?y(ra):y(oa,!1)},!0)}o(u,h)};b(ta,u=>{a(k)?u(ea):u(sa,!1)},!0)}o(i,f)};b(C,i=>{a(E)?i(A):i(N,!1)})}w(i=>{d(j,`Cluster #${a(c),v(()=>a(c).id)??""}`),d(q,i)},[()=>(a(c),v(()=>a(c).words.join(" · ")))]),o(e,t)};b(Z,e=>{a(c)?e(aa,!1):e($)})}s(M),s(F),w(()=>d(W,`loaded ${v(()=>D.length)??""} clusters`)),o(U,F),na()}export{Aa as component};
